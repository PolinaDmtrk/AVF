!function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function a(t){let e=0;$(".units ul").empty(),$.each(t,(t,n)=>{let{idAVF:a,idUnit:o,nameUnit:i,idCategory:s,idTransform:r,nameTransform:c}=n;o==e?$(`#${e}`).append($(`<p id="${a}" class="transform">${c}</p>`)):$(".units ul").append($(`<li class="unit">${i}</li><li id="${o}" class="unitTransform"><p id="${a}" class="transform">${c}</p></li>`)),e=o})}n.r(e);function o(t,e){let n=JSON.parse(localStorage.getItem("units"));n=n.filter(e=>t.some(t=>t==e.idCategory)),2!=e&&(n=n.filter(t=>e==t.prAVF)),a(n)}$(document).ready(()=>{let t,e=0,n=$("#AVFparameter select option:selected").attr("id"),i=0;function s(){const t=[];return $(".category:checked").each(function(){t.push($(this).val())}),t}new Promise((t,e)=>{$.ajax({url:"common.aspx/getCategories",data:"",dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:e=>{$.each(e.d,(t,e)=>{const n=`<li><label><input name="category" class="category" value="${e.id}" type="checkbox" checked>${e.FullName}</label></li>`;$("#categories ul").append(n)}),t("result")},error:function(t){alert(`error: ${t}`)},failure:function(t){alert(`failure: ${t}`)}})}).then(t=>{!function(t){$.ajax({url:"common.aspx/getUnits",data:"",dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{const e=[];localStorage.clear(),$.each(t.d,(t,n)=>{let{idAVF:a,idUnit:o,nameUnit:i,idCategory:s,nameTransform:r,prAVF:c}=n;""==r&&(r=i),e.push({idAVF:a,idUnit:o,nameTransform:r,nameUnit:i,idCategory:s,prAVF:c})}),a(e),localStorage.setItem("units",JSON.stringify(e))},error:function(t){alert(`error: ${t}`)},failure:function(t){alert(`failure: ${t}`)}})}()}).catch(t=>{console.log(t)}),$("#categories").on("change",".category",()=>{o(s(),n)}),$("#AVFparameter").on("change",()=>{n=$("#AVFparameter select option:selected").attr("id"),o(s(),n)}),$(".units").on("click",".unit",function(){$(this).next("li").is(":visible")?$(this).next("li").slideUp("slow"):($(".unitTransform").slideUp("slow"),$(this).next("li").slideToggle("slow"))}),$(".units").on("click",".transform",function(){e=$(this).attr("id"),$("#unitName").empty();const t=$(this).parent("li").prev()[0].textContent,n=$(this)[0].textContent;$("#unitName").append(t),n!=t&&$("#unitName").append(` / ${n}`),function(t){$("#unitTextDescription").empty(),$(".example").empty(),$.ajax({url:"common.aspx/getUnitInfo",data:`{"id": ${t}}`,dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{const{description:e,example:n}=t.d[0];$("#unitTextDescription").append(e),""!=n?$(".example").append($('<img class="imgExample" src="img/'+n+'"></img>')):console.log("Примера нет")}})}(e),function(t){$("#unitInParams").empty(),$.ajax({url:"common.aspx/getUnitInParameters",data:`{"id": ${t}}`,dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{$.each(t.d,(t,e)=>{let n="";const{paramtext:a,text:o,param_number:i}=e,s=`<li class="inParams" id="${i}">${n=""==a?o:a}</li>`;$("#unitInParams").append(s)})}})}(e),function(t){$("#unitOutParams").empty(),$.ajax({url:"common.aspx/getUnitOutParameters",data:`{"id": ${t}}`,dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{$.each(t.d,(t,e)=>{const n=`<li class="outParams" id="${e.id}">${e.name}</li>`;$("#unitOutParams").append(n)})}})}(e),$(".unitDescription").css("display","block")}),$("#unitSearch").on("input",()=>{!function(){const t=$("#unitSearch").val().toUpperCase(),e=$(".unit"),n=$(".unitTransform");$.each(e,(e,a)=>{a.textContent.toUpperCase().indexOf(t)>-1?(a.style.display="",n[e].style.display="none"):(a.style.display="none",n[e].style.display="none")})}()}),$(".exampleOut").on("click",".imgExample",function(){$("#modalImg")[0].src=this.src;const t=$(window).width()/$(window).height();$("#modalImg").css({height:"auto",width:"auto"}),this.height*t>this.width?$("#modalImg").css("height","85vh"):$("#modalImg").css("width","90vw"),$(".modalForImage").css("display","block")}),$(".update").on("click",()=>{0==i&&($.ajax({url:"common.aspx/getAllOutParameters",data:"",dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{$.each(t.d,(t,e)=>{const n=`<li id="${e.id}" class="outParamsAdminAll">${e.name}</li>`;$("#outParamAdminOutput ul").append(n)})}}),i=1),$(".modalForAdminForm").css("display","block")}),$(".close").on("click",()=>{$(".modalForImage").css("display","none"),$(".modalForAdminForm").css("display","none")}),$(".unitDescription").on("click",".update",()=>{$("#unitNameAdmin").empty(),$("#unitNameAdmin").append($("#unitName")[0].textContent),$(".adminForm__unitTextDescription").val($("#unitTextDescription").text()),$("#outParamAdminInput ul").empty(),$("#unitOutParams li").each(function(){const t=`<li id="${this.id}" class="outParamsAdmin">${this.textContent}</li>`;$("#outParamAdminInput ul").append(t)})}),$("#searchOutP").on("input",()=>{!function(){const t=$("#searchOutP").val().toUpperCase(),e=$(".outParamsAdminAll");$.each(e,(e,n)=>{n.textContent.toUpperCase().indexOf(t)>-1?$(n).css("display",""):$(n).css("display","none")})}()}),$("#outParamAdminOutput ul").on("click",".outParamsAdminAll",function(){const t=`<li id="${this.id}" class="outParamsAdmin">${this.textContent}</li>`;$("#outParamAdminInput ul").append(t)}),$("#outParamAdminInput ul").on("click",".outParamsAdmin",function(){$(this).remove()}),$("#outParamAdminInput ul").sortable(),$("input[type=file]").on("change",function(){t=this.files[0].name}),$(".button_update").on("click",()=>{!function(t,e){let n;n=$("#prAVFforTr").is(":checked")?1:0;let a=$(".adminForm__unitTextDescription").val();a=a.replace(/[<>a-zA-Z]/g,""),console.log("Запущено обновление"),$.ajax({url:"common.aspx/updateUnitInfo",data:`{"id": ${e}, "description": "${a}"}`,dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{console.log("Описание обновлено")},error:function(t){console.log(`error: ${t}`)},failure:function(t){console.log(`failure: ${t}`)}});const o=[];$("#outParamAdminInput li").each(function(t,n){o.push(`(${e},${n.id})`)});let i=o.join(",");$.ajax({url:"common.aspx/updateUnitOutParams",data:`{"id": ${e}, "outFields": "${i}"}`,dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{console.log("Выходные параметры обновлены")},error:function(t){console.log(`error: ${t}`)},failure:function(t){console.log(`failure: ${t}`)}}),null!=t&&$.ajax({url:"common.aspx/updateImageData",data:`{"id": ${e}, "examplePuth": "${t}"}`,dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{console.log("Пример обновлен")},error:function(t){console.log(`error: ${t}`)},failure:function(t){console.log(`failure: ${t}`)}}),$.ajax({url:"common.aspx/updatePrAVF",data:`{"id": ${e}, "prAVF": "${n}"}`,dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:t=>{console.log("Признак АВФ обновлен")},error:function(t){console.log(`error: ${t}`)},failure:function(t){console.log(`failure: ${t}`)}}),alert("Данные обновлены!")}(t,e)})})}]);